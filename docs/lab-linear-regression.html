<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Section 7 Lab: Linear Regression | Statistics Learning</title>
  <meta name="description" content="Section 7 Lab: Linear Regression | Statistics Learning" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Section 7 Lab: Linear Regression | Statistics Learning" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https//:www.ndleah.github.io/stat-learning/" />
  <meta property="og:image" content="https//:www.ndleah.github.io/stat-learning//img/illos/cover.png" />
  
  <meta name="github-repo" content="ndleah/stat-learning" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Section 7 Lab: Linear Regression | Statistics Learning" />
  
  
  <meta name="twitter:image" content="https//:www.ndleah.github.io/stat-learning//img/illos/cover.png" />




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="img/illos/favicon.ico" type="image/x-icon" />
<link rel="prev" href="case-study---marketing-plan.html"/>
<link rel="next" href="exercises.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><a href="./"><img src="img/illos/logo_2.png"></a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a>
<ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#aim-of-the-project"><i class="fa fa-check"></i><b>0.1</b> Aim Of The Project</a></li>
</ul></li>
<li class="part"><span><b>I STATISTICAL LEARNING</b></span></li>
<li class="chapter" data-level="1" data-path="what-is-statistical-learning.html"><a href="what-is-statistical-learning.html"><i class="fa fa-check"></i><b>1</b> What is Statistical Learning?</a>
<ul>
<li class="chapter" data-level="1.1" data-path="what-is-statistical-learning.html"><a href="what-is-statistical-learning.html#why-estimate-f"><i class="fa fa-check"></i><b>1.1</b> Why Estimate f?</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="what-is-statistical-learning.html"><a href="what-is-statistical-learning.html#prediction"><i class="fa fa-check"></i><b>1.1.1</b> Prediction</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="what-is-statistical-learning.html"><a href="what-is-statistical-learning.html#how-do-we-estimate-f"><i class="fa fa-check"></i><b>1.2</b> How Do We Estimate f?</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="what-is-statistical-learning.html"><a href="what-is-statistical-learning.html#parametric-methods"><i class="fa fa-check"></i><b>1.2.1</b> Parametric Methods</a></li>
<li class="chapter" data-level="1.2.2" data-path="what-is-statistical-learning.html"><a href="what-is-statistical-learning.html#non-parametric-methods"><i class="fa fa-check"></i><b>1.2.2</b> Non-Parametric Methods</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="what-is-statistical-learning.html"><a href="what-is-statistical-learning.html#the-tradeoff-between-prediction-accuracy-and-model-interpretability"><i class="fa fa-check"></i><b>1.3</b> The Tradeoff Between Prediction Accuracy and Model Interpretability</a></li>
<li class="chapter" data-level="1.4" data-path="what-is-statistical-learning.html"><a href="what-is-statistical-learning.html#supervised-vs.-unsupervised-learning"><i class="fa fa-check"></i><b>1.4</b> Supervised Vs. Unsupervised Learning</a></li>
<li class="chapter" data-level="1.5" data-path="what-is-statistical-learning.html"><a href="what-is-statistical-learning.html#regression-vs.-classification"><i class="fa fa-check"></i><b>1.5</b> Regression Vs. Classification</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="assessing-model-accuracy.html"><a href="assessing-model-accuracy.html"><i class="fa fa-check"></i><b>2</b> Assessing Model Accuracy</a>
<ul>
<li class="chapter" data-level="2.1" data-path="assessing-model-accuracy.html"><a href="assessing-model-accuracy.html#the-regression-setting"><i class="fa fa-check"></i><b>2.1</b> The Regression Setting</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="assessing-model-accuracy.html"><a href="assessing-model-accuracy.html#measuring-the-quality-of-fit"><i class="fa fa-check"></i><b>2.1.1</b> Measuring the Quality of fit</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="assessing-model-accuracy.html"><a href="assessing-model-accuracy.html#the-bias-variance-trade-off"><i class="fa fa-check"></i><b>2.2</b> The Bias-Variance Trade-Off</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="assessing-model-accuracy.html"><a href="assessing-model-accuracy.html#Variance-Error"><i class="fa fa-check"></i><b>2.2.1</b> Variance Error</a></li>
<li class="chapter" data-level="2.2.2" data-path="assessing-model-accuracy.html"><a href="assessing-model-accuracy.html#Bias-Error"><i class="fa fa-check"></i><b>2.2.2</b> Bias Error</a></li>
<li class="chapter" data-level="2.2.3" data-path="assessing-model-accuracy.html"><a href="assessing-model-accuracy.html#bias-variance-trafe-off"><i class="fa fa-check"></i><b>2.2.3</b> Bias-Variance Trafe-Off</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="assessing-model-accuracy.html"><a href="assessing-model-accuracy.html#the-classification-setting"><i class="fa fa-check"></i><b>2.3</b> The Classification Setting</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="assessing-model-accuracy.html"><a href="assessing-model-accuracy.html#bayes"><i class="fa fa-check"></i><b>2.3.1</b> The Bayes Classifier</a></li>
<li class="chapter" data-level="2.3.2" data-path="assessing-model-accuracy.html"><a href="assessing-model-accuracy.html#KNN"><i class="fa fa-check"></i><b>2.3.2</b> K-Nearest Neighbors (KNN)</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II LINEAR REGRESSION{#LINEAR-REGRESSION}</b></span></li>
<li class="chapter" data-level="3" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html"><i class="fa fa-check"></i><b>3</b> Simple Linear Regression</a>
<ul>
<li class="chapter" data-level="3.1" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#estimating-the-coefficients"><i class="fa fa-check"></i><b>3.1</b> Estimating the Coefficients</a></li>
<li class="chapter" data-level="3.2" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#assessing-the-accuracy-of-the-coefficient-estimates"><i class="fa fa-check"></i><b>3.2</b> Assessing the Accuracy of the Coefficient Estimates</a>
<ul>
<li class="chapter" data-level="" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#population-regression-line"><i class="fa fa-check"></i>Population Regression Line</a></li>
<li class="chapter" data-level="" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#least-squares-line"><i class="fa fa-check"></i>Least Squares Line</a></li>
<li><a href="simple-linear-regression.html#how-accurate-is-the-sample-mean-hatmu-as-an-estimate-of-population-mean-mu"><mark class="quest"> How Accurate Is The Sample Mean <span class="math inline">\(\hat{\mu}\)</span> As An Estimate Of Population Mean <span class="math inline">\(\mu\)</span> </mark></a></li>
<li><a href="simple-linear-regression.html#how-far-is-far-enough"><mark class="quest"> How Far Is Far Enough? </mark></a></li>
<li class="chapter" data-level="" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#t-distribution"><i class="fa fa-check"></i>T-distribution</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#assessing-the-accuracy-of-the-model"><i class="fa fa-check"></i><b>3.3</b> Assessing the Accuracy of the Model</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#residual-standard-error"><i class="fa fa-check"></i><b>3.3.1</b> Residual Standard Error</a></li>
<li class="chapter" data-level="3.3.2" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#r2-standard-error"><i class="fa fa-check"></i><b>3.3.2</b> <span class="math inline">\(R^2\)</span> Standard Error</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#consideration"><i class="fa fa-check"></i><b>3.4</b> Consideration</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html"><i class="fa fa-check"></i><b>4</b> Multiple Linear Regression</a>
<ul>
<li class="chapter" data-level="4.1" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#Response-and-Predictors-Relationships"><i class="fa fa-check"></i><b>4.1</b> Response and Predictors Relationships</a></li>
<li class="chapter" data-level="4.2" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#Dealing-With-Large-Number-Of-Variables"><i class="fa fa-check"></i><b>4.2</b> Dealing With Large Number Of Variables</a></li>
<li class="chapter" data-level="4.3" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#Model-Fit"><i class="fa fa-check"></i><b>4.3</b> Model Fit</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="other-considerations-in-the-regression-model.html"><a href="other-considerations-in-the-regression-model.html"><i class="fa fa-check"></i><b>5</b> Other Considerations in the Regression Model</a>
<ul>
<li class="chapter" data-level="5.1" data-path="other-considerations-in-the-regression-model.html"><a href="other-considerations-in-the-regression-model.html#Non-linearity-of-the-Data"><i class="fa fa-check"></i><b>5.1</b> Non-linearity of the Data</a></li>
<li class="chapter" data-level="5.2" data-path="other-considerations-in-the-regression-model.html"><a href="other-considerations-in-the-regression-model.html#corre-error-term"><i class="fa fa-check"></i><b>5.2</b> Correlation of Error Terms</a></li>
<li class="chapter" data-level="5.3" data-path="other-considerations-in-the-regression-model.html"><a href="other-considerations-in-the-regression-model.html#Non-Constant-Variance-of-Error-Terms"><i class="fa fa-check"></i><b>5.3</b> Non-constant Variance of Error Terms (Heteroscedasticity)</a></li>
<li class="chapter" data-level="5.4" data-path="other-considerations-in-the-regression-model.html"><a href="other-considerations-in-the-regression-model.html#Outlier"><i class="fa fa-check"></i><b>5.4</b> Outlier</a></li>
<li class="chapter" data-level="5.5" data-path="other-considerations-in-the-regression-model.html"><a href="other-considerations-in-the-regression-model.html#High-Leverage-Points"><i class="fa fa-check"></i><b>5.5</b> High Leverage Points</a></li>
<li class="chapter" data-level="5.6" data-path="other-considerations-in-the-regression-model.html"><a href="other-considerations-in-the-regression-model.html#Collinearity"><i class="fa fa-check"></i><b>5.6</b> Collinearity</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="other-considerations-in-the-regression-model.html"><a href="other-considerations-in-the-regression-model.html#correlation-matrix"><i class="fa fa-check"></i><b>5.6.1</b> Correlation Matrix</a></li>
<li class="chapter" data-level="5.6.2" data-path="other-considerations-in-the-regression-model.html"><a href="other-considerations-in-the-regression-model.html#variance-inflation-factor-vif"><i class="fa fa-check"></i><b>5.6.2</b> Variance Inflation Factor (VIF)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="case-study---marketing-plan.html"><a href="case-study---marketing-plan.html"><i class="fa fa-check"></i><b>6</b> Case Study - Marketing Plan</a>
<ul>
<li class="chapter" data-level="6.1" data-path="case-study---marketing-plan.html"><a href="case-study---marketing-plan.html#data-overview"><i class="fa fa-check"></i><b>6.1</b> Data Overview</a></li>
<li class="chapter" data-level="6.2" data-path="case-study---marketing-plan.html"><a href="case-study---marketing-plan.html#important-questions"><i class="fa fa-check"></i><b>6.2</b> Important Questions</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="lab-linear-regression.html"><a href="lab-linear-regression.html"><i class="fa fa-check"></i><b>7</b> Lab: Linear Regression</a>
<ul>
<li class="chapter" data-level="7.1" data-path="lab-linear-regression.html"><a href="lab-linear-regression.html#simple-linear-regression-1"><i class="fa fa-check"></i><b>7.1</b> Simple Linear Regression</a></li>
<li class="chapter" data-level="7.2" data-path="lab-linear-regression.html"><a href="lab-linear-regression.html#multiple-linear-regression-1"><i class="fa fa-check"></i><b>7.2</b> Multiple Linear Regression</a></li>
<li class="chapter" data-level="7.3" data-path="lab-linear-regression.html"><a href="lab-linear-regression.html#interaction-terms"><i class="fa fa-check"></i><b>7.3</b> Interaction Terms</a></li>
<li class="chapter" data-level="7.4" data-path="lab-linear-regression.html"><a href="lab-linear-regression.html#non-linear-transformations-of-the-predictors"><i class="fa fa-check"></i><b>7.4</b> Non-linear Transformations of the Predictors</a></li>
<li class="chapter" data-level="7.5" data-path="lab-linear-regression.html"><a href="lab-linear-regression.html#qualitative-predictors"><i class="fa fa-check"></i><b>7.5</b> Qualitative Predictors</a></li>
<li class="chapter" data-level="7.6" data-path="lab-linear-regression.html"><a href="lab-linear-regression.html#writing-functions"><i class="fa fa-check"></i><b>7.6</b> Writing Functions</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="exercises.html"><a href="exercises.html"><i class="fa fa-check"></i><b>8</b> Exercises</a></li>
<li class="part"><span><b>III CLASSIFICATION</b></span></li>
<li class="chapter" data-level="9" data-path="an-overview-of-classification.html"><a href="an-overview-of-classification.html"><i class="fa fa-check"></i><b>9</b> An Overview of Classification</a></li>
<li class="chapter" data-level="10" data-path="logistic-regression.html"><a href="logistic-regression.html"><i class="fa fa-check"></i><b>10</b> Logistic Regression</a>
<ul>
<li class="chapter" data-level="10.1" data-path="logistic-regression.html"><a href="logistic-regression.html#logistic-model"><i class="fa fa-check"></i><b>10.1</b> Logistic Model</a></li>
<li class="chapter" data-level="10.2" data-path="logistic-regression.html"><a href="logistic-regression.html#estimating-the-regression-coefficients"><i class="fa fa-check"></i><b>10.2</b> Estimating the Regression Coefficients</a></li>
<li class="chapter" data-level="10.3" data-path="logistic-regression.html"><a href="logistic-regression.html#multiple-logistic-regression"><i class="fa fa-check"></i><b>10.3</b> Multiple Logistic Regression</a></li>
<li class="chapter" data-level="10.4" data-path="logistic-regression.html"><a href="logistic-regression.html#multinomial-logistic-regression"><i class="fa fa-check"></i><b>10.4</b> Multinomial Logistic Regression</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="generative-models-for-classification.html"><a href="generative-models-for-classification.html"><i class="fa fa-check"></i><b>11</b> Generative Models for Classification</a>
<ul>
<li class="chapter" data-level="11.1" data-path="generative-models-for-classification.html"><a href="generative-models-for-classification.html#Linear-Discriminant-Analysis"><i class="fa fa-check"></i><b>11.1</b> Linear Discriminant Analysis</a>
<ul>
<li><a href="generative-models-for-classification.html#a.-when-p-1">a. When <span class="math inline">\(p\)</span> = 1</a></li>
<li><a href="generative-models-for-classification.html#b.-when-p-1">b. When <span class="math inline">\(p\)</span> &gt; 1</a></li>
<li class="chapter" data-level="" data-path="generative-models-for-classification.html"><a href="generative-models-for-classification.html#c.-problems-with-lda"><i class="fa fa-check"></i>c. Problems with LDA</a></li>
<li class="chapter" data-level="" data-path="generative-models-for-classification.html"><a href="generative-models-for-classification.html#d.-confusion-matrix"><i class="fa fa-check"></i>d. Confusion Matrix</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="generative-models-for-classification.html"><a href="generative-models-for-classification.html#QDA"><i class="fa fa-check"></i><b>11.2</b> Quadratic Discriminant Analysis</a>
<ul>
<li><a href="generative-models-for-classification.html#why-is-this-important"><mark class="quest">Why is this important?</mark></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="a-comparison-of-classification-methods.html"><a href="a-comparison-of-classification-methods.html"><i class="fa fa-check"></i><b>12</b> A Comparison of Classification Methods</a>
<ul>
<li class="chapter" data-level="" data-path="a-comparison-of-classification-methods.html"><a href="a-comparison-of-classification-methods.html#figure-for-scenarios-1-2-3"><i class="fa fa-check"></i>Figure for Scenarios 1, 2, 3</a></li>
<li class="chapter" data-level="12.1" data-path="a-comparison-of-classification-methods.html"><a href="a-comparison-of-classification-methods.html#scenario-1"><i class="fa fa-check"></i><b>12.1</b> Scenario 1</a></li>
<li class="chapter" data-level="12.2" data-path="a-comparison-of-classification-methods.html"><a href="a-comparison-of-classification-methods.html#scenario-2"><i class="fa fa-check"></i><b>12.2</b> Scenario 2</a></li>
<li class="chapter" data-level="12.3" data-path="a-comparison-of-classification-methods.html"><a href="a-comparison-of-classification-methods.html#scenario-3"><i class="fa fa-check"></i><b>12.3</b> Scenario 3</a></li>
<li class="chapter" data-level="" data-path="a-comparison-of-classification-methods.html"><a href="a-comparison-of-classification-methods.html#figure-for-scenarios-4-5-6"><i class="fa fa-check"></i>Figure for Scenarios 4, 5, 6</a></li>
<li class="chapter" data-level="12.4" data-path="a-comparison-of-classification-methods.html"><a href="a-comparison-of-classification-methods.html#scenario-4"><i class="fa fa-check"></i><b>12.4</b> Scenario 4</a></li>
<li class="chapter" data-level="12.5" data-path="a-comparison-of-classification-methods.html"><a href="a-comparison-of-classification-methods.html#scenario-5"><i class="fa fa-check"></i><b>12.5</b> Scenario 5</a></li>
<li class="chapter" data-level="12.6" data-path="a-comparison-of-classification-methods.html"><a href="a-comparison-of-classification-methods.html#scenario-6"><i class="fa fa-check"></i><b>12.6</b> Scenario 6</a></li>
<li class="chapter" data-level="" data-path="a-comparison-of-classification-methods.html"><a href="a-comparison-of-classification-methods.html#conclusion"><i class="fa fa-check"></i>Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html"><i class="fa fa-check"></i><b>13</b> Generalized Linear Model</a>
<ul>
<li class="chapter" data-level="13.1" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#overview"><i class="fa fa-check"></i><b>13.1</b> Overview</a></li>
<li class="chapter" data-level="13.2" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#generalized-linear-models-in-greater-generality"><i class="fa fa-check"></i><b>13.2</b> Generalized Linear Models in Greater Generality</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="lab-classification-methods.html"><a href="lab-classification-methods.html"><i class="fa fa-check"></i><b>14</b> Lab: Classification Methods</a>
<ul>
<li class="chapter" data-level="14.1" data-path="lab-classification-methods.html"><a href="lab-classification-methods.html#the-stock-market-data"><i class="fa fa-check"></i><b>14.1</b> The Stock Market Data</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="lab-classification-methods.html"><a href="lab-classification-methods.html#data-overview-1"><i class="fa fa-check"></i><b>14.1.1</b> Data Overview</a></li>
<li class="chapter" data-level="14.1.2" data-path="lab-classification-methods.html"><a href="lab-classification-methods.html#logistic-regression-1"><i class="fa fa-check"></i><b>14.1.2</b> Logistic Regression</a></li>
<li class="chapter" data-level="14.1.3" data-path="lab-classification-methods.html"><a href="lab-classification-methods.html#linear-discriminant-analysis"><i class="fa fa-check"></i><b>14.1.3</b> Linear Discriminant Analysis</a></li>
<li class="chapter" data-level="14.1.4" data-path="lab-classification-methods.html"><a href="lab-classification-methods.html#quadratic-discriminant-analysis"><i class="fa fa-check"></i><b>14.1.4</b> Quadratic Discriminant Analysis</a></li>
<li class="chapter" data-level="14.1.5" data-path="lab-classification-methods.html"><a href="lab-classification-methods.html#naive-bayes"><i class="fa fa-check"></i><b>14.1.5</b> Naive Bayes</a></li>
<li class="chapter" data-level="14.1.6" data-path="lab-classification-methods.html"><a href="lab-classification-methods.html#k-nearest-neighbors"><i class="fa fa-check"></i><b>14.1.6</b> K-Nearest Neighbors</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="lab-classification-methods.html"><a href="lab-classification-methods.html#the-caravan-insurance-data"><i class="fa fa-check"></i><b>14.2</b> The Caravan Insurance Data</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="lab-classification-methods.html"><a href="lab-classification-methods.html#data-overview-2"><i class="fa fa-check"></i><b>14.2.1</b> Data Overview</a></li>
<li class="chapter" data-level="14.2.2" data-path="lab-classification-methods.html"><a href="lab-classification-methods.html#k-nearest-neighbors-1"><i class="fa fa-check"></i><b>14.2.2</b> K-Nearest Neighbors</a></li>
<li class="chapter" data-level="14.2.3" data-path="lab-classification-methods.html"><a href="lab-classification-methods.html#logistics-regression"><i class="fa fa-check"></i><b>14.2.3</b> Logistics Regression</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="lab-classification-methods.html"><a href="lab-classification-methods.html#bikeshare-data"><i class="fa fa-check"></i><b>14.3</b> Bikeshare Data</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="lab-classification-methods.html"><a href="lab-classification-methods.html#data-overview-3"><i class="fa fa-check"></i><b>14.3.1</b> Data Overview</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>IV RESAMPLING METHOD</b></span></li>
<li class="chapter" data-level="15" data-path="an-overview-of-resampling-methods.html"><a href="an-overview-of-resampling-methods.html"><i class="fa fa-check"></i><b>15</b> An Overview of Resampling Methods</a></li>
<li class="chapter" data-level="16" data-path="cross-validation.html"><a href="cross-validation.html"><i class="fa fa-check"></i><b>16</b> Cross-Validation</a>
<ul>
<li class="chapter" data-level="16.1" data-path="cross-validation.html"><a href="cross-validation.html#test-and-training-error-rate"><i class="fa fa-check"></i><b>16.1</b> Test and Training Error Rate</a></li>
<li class="chapter" data-level="16.2" data-path="cross-validation.html"><a href="cross-validation.html#vsa"><i class="fa fa-check"></i><b>16.2</b> The Validation Set Approach</a></li>
<li class="chapter" data-level="16.3" data-path="cross-validation.html"><a href="cross-validation.html#LOOCV"><i class="fa fa-check"></i><b>16.3</b> Leave-One-Out Cross-Validation</a></li>
<li class="chapter" data-level="16.4" data-path="cross-validation.html"><a href="cross-validation.html#k-fold-cross-validation"><i class="fa fa-check"></i><b>16.4</b> <span class="math inline">\(k\)</span>-Fold Cross-Validation</a></li>
<li class="chapter" data-level="16.5" data-path="cross-validation.html"><a href="cross-validation.html#bias-variance-trade-off-for-k-fold-cross-validation"><i class="fa fa-check"></i><b>16.5</b> Bias-Variance Trade-Off for k-Fold Cross-Validation</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="the-bootstrap.html"><a href="the-bootstrap.html"><i class="fa fa-check"></i><b>17</b> The Bootstrap</a></li>
<li class="chapter" data-level="18" data-path="lab-resampling-methods.html"><a href="lab-resampling-methods.html"><i class="fa fa-check"></i><b>18</b> Lab: Resampling Methods</a>
<ul>
<li class="chapter" data-level="18.1" data-path="lab-resampling-methods.html"><a href="lab-resampling-methods.html#the-validation-set-approach"><i class="fa fa-check"></i><b>18.1</b> The Validation Set Approach</a></li>
<li class="chapter" data-level="18.2" data-path="lab-resampling-methods.html"><a href="lab-resampling-methods.html#leave-one-out-cross-validation"><i class="fa fa-check"></i><b>18.2</b> Leave-One-Out Cross-Validation</a></li>
<li class="chapter" data-level="18.3" data-path="lab-resampling-methods.html"><a href="lab-resampling-methods.html#k-fold-cross-validation-1"><i class="fa fa-check"></i><b>18.3</b> <span class="math inline">\(k\)</span>-Fold Cross-Validation</a></li>
<li class="chapter" data-level="18.4" data-path="lab-resampling-methods.html"><a href="lab-resampling-methods.html#the-bootstrap-1"><i class="fa fa-check"></i><b>18.4</b> The Bootstrap</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/ndleah/stat-learning" target="blank">View my GitHub</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistics Learning</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<link href="style.css" rel="stylesheet">
<div class="hero-image-container"> 
  <img class= "hero-image" src="img/illos/cover.png">
</div>
<div id="lab-linear-regression" class="section level1" number="7">
<h1><span class="header-section-number">Section 7</span> Lab: Linear Regression</h1>
<center>
<img src="img/illos/02-lab.png" />
</center>
<div class="sourceCode" id="cb1"><pre class="sourceCode r Rchunk"><code class="sourceCode r"><span id="cb1-1"><a href="lab-linear-regression.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the library</span></span>
<span id="cb1-2"><a href="lab-linear-regression.html#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb1-3"><a href="lab-linear-regression.html#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ISLR)</span></code></pre></div>
<div id="simple-linear-regression-1" class="section level2" number="7.1">
<h2><span class="header-section-number">7.1</span> Simple Linear Regression</h2>
<p>The Boston data set records <code>medv</code> (median house value) for 506 neighborhoods around Boston. We will seek to predict <code>medv</code> using 13 predictors such as <code>rm</code> (average number of rooms per house), <code>age</code> (average age of houses), and <code>lstat</code> (percent of households with low socioeconomic status).</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r Rchunk"><code class="sourceCode r"><span id="cb2-1"><a href="lab-linear-regression.html#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(Boston)</span>
<span id="cb2-2"><a href="lab-linear-regression.html#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="do">##  [1] &quot;crim&quot;    &quot;zn&quot;      &quot;indus&quot;   &quot;chas&quot;    &quot;nox&quot;     &quot;rm&quot;      &quot;age&quot;    </span></span>
<span id="cb2-3"><a href="lab-linear-regression.html#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="do">##  [8] &quot;dis&quot;     &quot;rad&quot;     &quot;tax&quot;     &quot;ptratio&quot; &quot;black&quot;   &quot;lstat&quot;   &quot;medv&quot;</span></span></code></pre></div>
<p>We will start by using the <code>lm()</code> function to fit a simple linear regression <code>lm()</code> model, with <code>medv</code> as the response and <code>lstat</code> as the predictor.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r Rchunk"><code class="sourceCode r"><span id="cb3-1"><a href="lab-linear-regression.html#cb3-1" aria-hidden="true" tabindex="-1"></a>lm.fit <span class="ot">=</span> <span class="fu">lm</span>(medv <span class="sc">~</span> lstat, Boston)</span>
<span id="cb3-2"><a href="lab-linear-regression.html#cb3-2" aria-hidden="true" tabindex="-1"></a>lm.fit</span>
<span id="cb3-3"><a href="lab-linear-regression.html#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb3-4"><a href="lab-linear-regression.html#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Call:</span></span>
<span id="cb3-5"><a href="lab-linear-regression.html#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="do">## lm(formula = medv ~ lstat, data = Boston)</span></span>
<span id="cb3-6"><a href="lab-linear-regression.html#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb3-7"><a href="lab-linear-regression.html#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Coefficients:</span></span>
<span id="cb3-8"><a href="lab-linear-regression.html#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="do">## (Intercept)        lstat  </span></span>
<span id="cb3-9"><a href="lab-linear-regression.html#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="do">##       34.55        -0.95</span></span></code></pre></div>
<p>For more detailed information, we use <code>summary(lm.fit)</code>. This gives us p-values and standard errors for the coefficients, as well as the <span class="math inline">\(R^2\)</span> statistic and F-statistic for the model.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r Rchunk"><code class="sourceCode r"><span id="cb4-1"><a href="lab-linear-regression.html#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm.fit)</span>
<span id="cb4-2"><a href="lab-linear-regression.html#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb4-3"><a href="lab-linear-regression.html#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Call:</span></span>
<span id="cb4-4"><a href="lab-linear-regression.html#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="do">## lm(formula = medv ~ lstat, data = Boston)</span></span>
<span id="cb4-5"><a href="lab-linear-regression.html#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb4-6"><a href="lab-linear-regression.html#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Residuals:</span></span>
<span id="cb4-7"><a href="lab-linear-regression.html#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="do">##     Min      1Q  Median      3Q     Max </span></span>
<span id="cb4-8"><a href="lab-linear-regression.html#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="do">## -15.168  -3.990  -1.318   2.034  24.500 </span></span>
<span id="cb4-9"><a href="lab-linear-regression.html#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb4-10"><a href="lab-linear-regression.html#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Coefficients:</span></span>
<span id="cb4-11"><a href="lab-linear-regression.html#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="do">##             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb4-12"><a href="lab-linear-regression.html#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="do">## (Intercept) 34.55384    0.56263   61.41   &lt;2e-16 ***</span></span>
<span id="cb4-13"><a href="lab-linear-regression.html#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="do">## lstat       -0.95005    0.03873  -24.53   &lt;2e-16 ***</span></span>
<span id="cb4-14"><a href="lab-linear-regression.html#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb4-15"><a href="lab-linear-regression.html#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb4-16"><a href="lab-linear-regression.html#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb4-17"><a href="lab-linear-regression.html#cb4-17" aria-hidden="true" tabindex="-1"></a><span class="do">## Residual standard error: 6.216 on 504 degrees of freedom</span></span>
<span id="cb4-18"><a href="lab-linear-regression.html#cb4-18" aria-hidden="true" tabindex="-1"></a><span class="do">## Multiple R-squared:  0.5441, Adjusted R-squared:  0.5432 </span></span>
<span id="cb4-19"><a href="lab-linear-regression.html#cb4-19" aria-hidden="true" tabindex="-1"></a><span class="do">## F-statistic: 601.6 on 1 and 504 DF,  p-value: &lt; 2.2e-16</span></span></code></pre></div>
<p>We can use <code>names()</code> function in order to find out what other pieces of information are store in <code>lm.fit</code>.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r Rchunk"><code class="sourceCode r"><span id="cb5-1"><a href="lab-linear-regression.html#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(lm.fit)</span>
<span id="cb5-2"><a href="lab-linear-regression.html#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="do">##  [1] &quot;coefficients&quot;  &quot;residuals&quot;     &quot;effects&quot;       &quot;rank&quot;         </span></span>
<span id="cb5-3"><a href="lab-linear-regression.html#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="do">##  [5] &quot;fitted.values&quot; &quot;assign&quot;        &quot;qr&quot;            &quot;df.residual&quot;  </span></span>
<span id="cb5-4"><a href="lab-linear-regression.html#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="do">##  [9] &quot;xlevels&quot;       &quot;call&quot;          &quot;terms&quot;         &quot;model&quot;</span></span></code></pre></div>
<p>Assessing the coefficient of the model:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r Rchunk"><code class="sourceCode r"><span id="cb6-1"><a href="lab-linear-regression.html#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(lm.fit)</span>
<span id="cb6-2"><a href="lab-linear-regression.html#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="do">## (Intercept)       lstat </span></span>
<span id="cb6-3"><a href="lab-linear-regression.html#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="do">##  34.5538409  -0.9500494</span></span></code></pre></div>
<p>Assessing the confidence interval for the coefficient estimates:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r Rchunk"><code class="sourceCode r"><span id="cb7-1"><a href="lab-linear-regression.html#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(lm.fit)</span>
<span id="cb7-2"><a href="lab-linear-regression.html#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="do">##                 2.5 %     97.5 %</span></span>
<span id="cb7-3"><a href="lab-linear-regression.html#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="do">## (Intercept) 33.448457 35.6592247</span></span>
<span id="cb7-4"><a href="lab-linear-regression.html#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="do">## lstat       -1.026148 -0.8739505</span></span></code></pre></div>
<p>To produce confidence interval an prediction intervals for the prediction of <code>medv</code> for a given value of <code>lstat</code>.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r Rchunk"><code class="sourceCode r"><span id="cb8-1"><a href="lab-linear-regression.html#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(lm.fit, <span class="fu">data.frame</span>(<span class="at">lstat =</span> (<span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">15</span>))), <span class="at">interval =</span> <span class="st">&quot;confidence&quot;</span>)</span>
<span id="cb8-2"><a href="lab-linear-regression.html#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="do">##        fit      lwr      upr</span></span>
<span id="cb8-3"><a href="lab-linear-regression.html#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="do">## 1 29.80359 29.00741 30.59978</span></span>
<span id="cb8-4"><a href="lab-linear-regression.html#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="do">## 2 25.05335 24.47413 25.63256</span></span>
<span id="cb8-5"><a href="lab-linear-regression.html#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="do">## 3 20.30310 19.73159 20.87461</span></span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="sourceCode r Rchunk"><code class="sourceCode r"><span id="cb9-1"><a href="lab-linear-regression.html#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(lm.fit, <span class="fu">data.frame</span>(<span class="at">lstat =</span> (<span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">15</span>))), <span class="at">interval =</span> <span class="st">&quot;prediction&quot;</span>)</span>
<span id="cb9-2"><a href="lab-linear-regression.html#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="do">##        fit       lwr      upr</span></span>
<span id="cb9-3"><a href="lab-linear-regression.html#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="do">## 1 29.80359 17.565675 42.04151</span></span>
<span id="cb9-4"><a href="lab-linear-regression.html#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="do">## 2 25.05335 12.827626 37.27907</span></span>
<span id="cb9-5"><a href="lab-linear-regression.html#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="do">## 3 20.30310  8.077742 32.52846</span></span></code></pre></div>
<p>We will now plot <code>medv</code> and <code>lstat</code> along with the least squares regression line using the <code>plot()</code> and <code>abline()</code> functions.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r Rchunk"><code class="sourceCode r"><span id="cb10-1"><a href="lab-linear-regression.html#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(Boston)</span>
<span id="cb10-2"><a href="lab-linear-regression.html#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lstat, medv)</span>
<span id="cb10-3"><a href="lab-linear-regression.html#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(lm.fit)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-19-1.png" width="672" style="display: block; margin: auto;" />
Next we examine some diagnostic plots, several of which were discussed. Four diagnostic plots are automatically produced by applying the <code>plot()</code> function directly to the output from <code>lm()</code>.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r Rchunk"><code class="sourceCode r"><span id="cb11-1"><a href="lab-linear-regression.html#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb11-2"><a href="lab-linear-regression.html#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lm.fit)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-20-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r Rchunk"><code class="sourceCode r"><span id="cb12-1"><a href="lab-linear-regression.html#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">predict</span>(lm.fit), <span class="fu">residuals</span>(lm.fit))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-21-1.png" width="672" style="display: block; margin: auto;" />
Alternatively, we can compute the residuals from a linear regression fit using the <code>residuals()</code> function. The function <code>rstudent()</code> will return the studentized residuals, and we can use this function to plot the residuals against the fitted values.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r Rchunk"><code class="sourceCode r"><span id="cb13-1"><a href="lab-linear-regression.html#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">predict</span>(lm.fit), <span class="fu">rstudent</span>(lm.fit))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-22-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>On the basis of the residual plots, there is some evidence of non-linearity. Leverage statistics can be computed for any number of predictors using the <code>hatvalues()</code> function.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r Rchunk"><code class="sourceCode r"><span id="cb14-1"><a href="lab-linear-regression.html#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">hatvalues</span>(lm.fit))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-23-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>The <code>which.max()</code> function identifies the index of the largest element of a <code>which.max()</code> vector. In this case, it tells us which observation has the largest leverage statistic.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r Rchunk"><code class="sourceCode r"><span id="cb15-1"><a href="lab-linear-regression.html#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">which.max</span>(<span class="fu">hatvalues</span>(lm.fit))</span>
<span id="cb15-2"><a href="lab-linear-regression.html#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="do">## 375 </span></span>
<span id="cb15-3"><a href="lab-linear-regression.html#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="do">## 375</span></span></code></pre></div>
</div>
<div id="multiple-linear-regression-1" class="section level2" number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Linear Regression</h2>
<p>In order to fit a multiple linear regression model using least squares, we again use the <code>lm()</code> function. The syntax <code>lm(y ∼ x1 + x2 + x3)</code> is used to fit a model with three predictors, <code>x1</code>, <code>x2</code>, and <code>x3.</code> The <code>summary()</code> function now outputs the regression coefficients for all the predictors.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r Rchunk"><code class="sourceCode r"><span id="cb16-1"><a href="lab-linear-regression.html#cb16-1" aria-hidden="true" tabindex="-1"></a>lm.fit <span class="ot">=</span> <span class="fu">lm</span>(medv <span class="sc">~</span> lstat <span class="sc">+</span> age, <span class="at">data =</span> Boston)</span>
<span id="cb16-2"><a href="lab-linear-regression.html#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm.fit)</span>
<span id="cb16-3"><a href="lab-linear-regression.html#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb16-4"><a href="lab-linear-regression.html#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Call:</span></span>
<span id="cb16-5"><a href="lab-linear-regression.html#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="do">## lm(formula = medv ~ lstat + age, data = Boston)</span></span>
<span id="cb16-6"><a href="lab-linear-regression.html#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb16-7"><a href="lab-linear-regression.html#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Residuals:</span></span>
<span id="cb16-8"><a href="lab-linear-regression.html#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="do">##     Min      1Q  Median      3Q     Max </span></span>
<span id="cb16-9"><a href="lab-linear-regression.html#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="do">## -15.981  -3.978  -1.283   1.968  23.158 </span></span>
<span id="cb16-10"><a href="lab-linear-regression.html#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb16-11"><a href="lab-linear-regression.html#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Coefficients:</span></span>
<span id="cb16-12"><a href="lab-linear-regression.html#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="do">##             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb16-13"><a href="lab-linear-regression.html#cb16-13" aria-hidden="true" tabindex="-1"></a><span class="do">## (Intercept) 33.22276    0.73085  45.458  &lt; 2e-16 ***</span></span>
<span id="cb16-14"><a href="lab-linear-regression.html#cb16-14" aria-hidden="true" tabindex="-1"></a><span class="do">## lstat       -1.03207    0.04819 -21.416  &lt; 2e-16 ***</span></span>
<span id="cb16-15"><a href="lab-linear-regression.html#cb16-15" aria-hidden="true" tabindex="-1"></a><span class="do">## age          0.03454    0.01223   2.826  0.00491 ** </span></span>
<span id="cb16-16"><a href="lab-linear-regression.html#cb16-16" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb16-17"><a href="lab-linear-regression.html#cb16-17" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb16-18"><a href="lab-linear-regression.html#cb16-18" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb16-19"><a href="lab-linear-regression.html#cb16-19" aria-hidden="true" tabindex="-1"></a><span class="do">## Residual standard error: 6.173 on 503 degrees of freedom</span></span>
<span id="cb16-20"><a href="lab-linear-regression.html#cb16-20" aria-hidden="true" tabindex="-1"></a><span class="do">## Multiple R-squared:  0.5513, Adjusted R-squared:  0.5495 </span></span>
<span id="cb16-21"><a href="lab-linear-regression.html#cb16-21" aria-hidden="true" tabindex="-1"></a><span class="do">## F-statistic:   309 on 2 and 503 DF,  p-value: &lt; 2.2e-16</span></span></code></pre></div>
<p>To perform a regression using all of the predictors, we can use:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r Rchunk"><code class="sourceCode r"><span id="cb17-1"><a href="lab-linear-regression.html#cb17-1" aria-hidden="true" tabindex="-1"></a>lm.fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(medv <span class="sc">~</span> ., <span class="at">data =</span> Boston)</span>
<span id="cb17-2"><a href="lab-linear-regression.html#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm.fit)</span>
<span id="cb17-3"><a href="lab-linear-regression.html#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb17-4"><a href="lab-linear-regression.html#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Call:</span></span>
<span id="cb17-5"><a href="lab-linear-regression.html#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="do">## lm(formula = medv ~ ., data = Boston)</span></span>
<span id="cb17-6"><a href="lab-linear-regression.html#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb17-7"><a href="lab-linear-regression.html#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Residuals:</span></span>
<span id="cb17-8"><a href="lab-linear-regression.html#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="do">##     Min      1Q  Median      3Q     Max </span></span>
<span id="cb17-9"><a href="lab-linear-regression.html#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="do">## -15.595  -2.730  -0.518   1.777  26.199 </span></span>
<span id="cb17-10"><a href="lab-linear-regression.html#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb17-11"><a href="lab-linear-regression.html#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Coefficients:</span></span>
<span id="cb17-12"><a href="lab-linear-regression.html#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="do">##               Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb17-13"><a href="lab-linear-regression.html#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="do">## (Intercept)  3.646e+01  5.103e+00   7.144 3.28e-12 ***</span></span>
<span id="cb17-14"><a href="lab-linear-regression.html#cb17-14" aria-hidden="true" tabindex="-1"></a><span class="do">## crim        -1.080e-01  3.286e-02  -3.287 0.001087 ** </span></span>
<span id="cb17-15"><a href="lab-linear-regression.html#cb17-15" aria-hidden="true" tabindex="-1"></a><span class="do">## zn           4.642e-02  1.373e-02   3.382 0.000778 ***</span></span>
<span id="cb17-16"><a href="lab-linear-regression.html#cb17-16" aria-hidden="true" tabindex="-1"></a><span class="do">## indus        2.056e-02  6.150e-02   0.334 0.738288    </span></span>
<span id="cb17-17"><a href="lab-linear-regression.html#cb17-17" aria-hidden="true" tabindex="-1"></a><span class="do">## chas         2.687e+00  8.616e-01   3.118 0.001925 ** </span></span>
<span id="cb17-18"><a href="lab-linear-regression.html#cb17-18" aria-hidden="true" tabindex="-1"></a><span class="do">## nox         -1.777e+01  3.820e+00  -4.651 4.25e-06 ***</span></span>
<span id="cb17-19"><a href="lab-linear-regression.html#cb17-19" aria-hidden="true" tabindex="-1"></a><span class="do">## rm           3.810e+00  4.179e-01   9.116  &lt; 2e-16 ***</span></span>
<span id="cb17-20"><a href="lab-linear-regression.html#cb17-20" aria-hidden="true" tabindex="-1"></a><span class="do">## age          6.922e-04  1.321e-02   0.052 0.958229    </span></span>
<span id="cb17-21"><a href="lab-linear-regression.html#cb17-21" aria-hidden="true" tabindex="-1"></a><span class="do">## dis         -1.476e+00  1.995e-01  -7.398 6.01e-13 ***</span></span>
<span id="cb17-22"><a href="lab-linear-regression.html#cb17-22" aria-hidden="true" tabindex="-1"></a><span class="do">## rad          3.060e-01  6.635e-02   4.613 5.07e-06 ***</span></span>
<span id="cb17-23"><a href="lab-linear-regression.html#cb17-23" aria-hidden="true" tabindex="-1"></a><span class="do">## tax         -1.233e-02  3.760e-03  -3.280 0.001112 ** </span></span>
<span id="cb17-24"><a href="lab-linear-regression.html#cb17-24" aria-hidden="true" tabindex="-1"></a><span class="do">## ptratio     -9.527e-01  1.308e-01  -7.283 1.31e-12 ***</span></span>
<span id="cb17-25"><a href="lab-linear-regression.html#cb17-25" aria-hidden="true" tabindex="-1"></a><span class="do">## black        9.312e-03  2.686e-03   3.467 0.000573 ***</span></span>
<span id="cb17-26"><a href="lab-linear-regression.html#cb17-26" aria-hidden="true" tabindex="-1"></a><span class="do">## lstat       -5.248e-01  5.072e-02 -10.347  &lt; 2e-16 ***</span></span>
<span id="cb17-27"><a href="lab-linear-regression.html#cb17-27" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb17-28"><a href="lab-linear-regression.html#cb17-28" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb17-29"><a href="lab-linear-regression.html#cb17-29" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb17-30"><a href="lab-linear-regression.html#cb17-30" aria-hidden="true" tabindex="-1"></a><span class="do">## Residual standard error: 4.745 on 492 degrees of freedom</span></span>
<span id="cb17-31"><a href="lab-linear-regression.html#cb17-31" aria-hidden="true" tabindex="-1"></a><span class="do">## Multiple R-squared:  0.7406, Adjusted R-squared:  0.7338 </span></span>
<span id="cb17-32"><a href="lab-linear-regression.html#cb17-32" aria-hidden="true" tabindex="-1"></a><span class="do">## F-statistic: 108.1 on 13 and 492 DF,  p-value: &lt; 2.2e-16</span></span></code></pre></div>
<p>To perform a regression using all of the variables but one, we can use:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r Rchunk"><code class="sourceCode r"><span id="cb18-1"><a href="lab-linear-regression.html#cb18-1" aria-hidden="true" tabindex="-1"></a>lm.fit1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(medv <span class="sc">~</span> . <span class="sc">-</span> age, <span class="at">data =</span> Boston)</span>
<span id="cb18-2"><a href="lab-linear-regression.html#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm.fit1)</span>
<span id="cb18-3"><a href="lab-linear-regression.html#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb18-4"><a href="lab-linear-regression.html#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Call:</span></span>
<span id="cb18-5"><a href="lab-linear-regression.html#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="do">## lm(formula = medv ~ . - age, data = Boston)</span></span>
<span id="cb18-6"><a href="lab-linear-regression.html#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb18-7"><a href="lab-linear-regression.html#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Residuals:</span></span>
<span id="cb18-8"><a href="lab-linear-regression.html#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="do">##      Min       1Q   Median       3Q      Max </span></span>
<span id="cb18-9"><a href="lab-linear-regression.html#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="do">## -15.6054  -2.7313  -0.5188   1.7601  26.2243 </span></span>
<span id="cb18-10"><a href="lab-linear-regression.html#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb18-11"><a href="lab-linear-regression.html#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Coefficients:</span></span>
<span id="cb18-12"><a href="lab-linear-regression.html#cb18-12" aria-hidden="true" tabindex="-1"></a><span class="do">##               Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb18-13"><a href="lab-linear-regression.html#cb18-13" aria-hidden="true" tabindex="-1"></a><span class="do">## (Intercept)  36.436927   5.080119   7.172 2.72e-12 ***</span></span>
<span id="cb18-14"><a href="lab-linear-regression.html#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="do">## crim         -0.108006   0.032832  -3.290 0.001075 ** </span></span>
<span id="cb18-15"><a href="lab-linear-regression.html#cb18-15" aria-hidden="true" tabindex="-1"></a><span class="do">## zn            0.046334   0.013613   3.404 0.000719 ***</span></span>
<span id="cb18-16"><a href="lab-linear-regression.html#cb18-16" aria-hidden="true" tabindex="-1"></a><span class="do">## indus         0.020562   0.061433   0.335 0.737989    </span></span>
<span id="cb18-17"><a href="lab-linear-regression.html#cb18-17" aria-hidden="true" tabindex="-1"></a><span class="do">## chas          2.689026   0.859598   3.128 0.001863 ** </span></span>
<span id="cb18-18"><a href="lab-linear-regression.html#cb18-18" aria-hidden="true" tabindex="-1"></a><span class="do">## nox         -17.713540   3.679308  -4.814 1.97e-06 ***</span></span>
<span id="cb18-19"><a href="lab-linear-regression.html#cb18-19" aria-hidden="true" tabindex="-1"></a><span class="do">## rm            3.814394   0.408480   9.338  &lt; 2e-16 ***</span></span>
<span id="cb18-20"><a href="lab-linear-regression.html#cb18-20" aria-hidden="true" tabindex="-1"></a><span class="do">## dis          -1.478612   0.190611  -7.757 5.03e-14 ***</span></span>
<span id="cb18-21"><a href="lab-linear-regression.html#cb18-21" aria-hidden="true" tabindex="-1"></a><span class="do">## rad           0.305786   0.066089   4.627 4.75e-06 ***</span></span>
<span id="cb18-22"><a href="lab-linear-regression.html#cb18-22" aria-hidden="true" tabindex="-1"></a><span class="do">## tax          -0.012329   0.003755  -3.283 0.001099 ** </span></span>
<span id="cb18-23"><a href="lab-linear-regression.html#cb18-23" aria-hidden="true" tabindex="-1"></a><span class="do">## ptratio      -0.952211   0.130294  -7.308 1.10e-12 ***</span></span>
<span id="cb18-24"><a href="lab-linear-regression.html#cb18-24" aria-hidden="true" tabindex="-1"></a><span class="do">## black         0.009321   0.002678   3.481 0.000544 ***</span></span>
<span id="cb18-25"><a href="lab-linear-regression.html#cb18-25" aria-hidden="true" tabindex="-1"></a><span class="do">## lstat        -0.523852   0.047625 -10.999  &lt; 2e-16 ***</span></span>
<span id="cb18-26"><a href="lab-linear-regression.html#cb18-26" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb18-27"><a href="lab-linear-regression.html#cb18-27" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb18-28"><a href="lab-linear-regression.html#cb18-28" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb18-29"><a href="lab-linear-regression.html#cb18-29" aria-hidden="true" tabindex="-1"></a><span class="do">## Residual standard error: 4.74 on 493 degrees of freedom</span></span>
<span id="cb18-30"><a href="lab-linear-regression.html#cb18-30" aria-hidden="true" tabindex="-1"></a><span class="do">## Multiple R-squared:  0.7406, Adjusted R-squared:  0.7343 </span></span>
<span id="cb18-31"><a href="lab-linear-regression.html#cb18-31" aria-hidden="true" tabindex="-1"></a><span class="do">## F-statistic: 117.3 on 12 and 493 DF,  p-value: &lt; 2.2e-16</span></span></code></pre></div>
<p>or Alternatively, the <code>update()</code> function can be used:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r Rchunk"><code class="sourceCode r"><span id="cb19-1"><a href="lab-linear-regression.html#cb19-1" aria-hidden="true" tabindex="-1"></a>lm.fit1 <span class="ot">&lt;-</span> <span class="fu">update</span>(lm.fit, <span class="sc">~</span>. <span class="sc">-</span> age)</span>
<span id="cb19-2"><a href="lab-linear-regression.html#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm.fit1)</span>
<span id="cb19-3"><a href="lab-linear-regression.html#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb19-4"><a href="lab-linear-regression.html#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Call:</span></span>
<span id="cb19-5"><a href="lab-linear-regression.html#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="do">## lm(formula = medv ~ crim + zn + indus + chas + nox + rm + dis + </span></span>
<span id="cb19-6"><a href="lab-linear-regression.html#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="do">##     rad + tax + ptratio + black + lstat, data = Boston)</span></span>
<span id="cb19-7"><a href="lab-linear-regression.html#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb19-8"><a href="lab-linear-regression.html#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Residuals:</span></span>
<span id="cb19-9"><a href="lab-linear-regression.html#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="do">##      Min       1Q   Median       3Q      Max </span></span>
<span id="cb19-10"><a href="lab-linear-regression.html#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="do">## -15.6054  -2.7313  -0.5188   1.7601  26.2243 </span></span>
<span id="cb19-11"><a href="lab-linear-regression.html#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb19-12"><a href="lab-linear-regression.html#cb19-12" aria-hidden="true" tabindex="-1"></a><span class="do">## Coefficients:</span></span>
<span id="cb19-13"><a href="lab-linear-regression.html#cb19-13" aria-hidden="true" tabindex="-1"></a><span class="do">##               Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb19-14"><a href="lab-linear-regression.html#cb19-14" aria-hidden="true" tabindex="-1"></a><span class="do">## (Intercept)  36.436927   5.080119   7.172 2.72e-12 ***</span></span>
<span id="cb19-15"><a href="lab-linear-regression.html#cb19-15" aria-hidden="true" tabindex="-1"></a><span class="do">## crim         -0.108006   0.032832  -3.290 0.001075 ** </span></span>
<span id="cb19-16"><a href="lab-linear-regression.html#cb19-16" aria-hidden="true" tabindex="-1"></a><span class="do">## zn            0.046334   0.013613   3.404 0.000719 ***</span></span>
<span id="cb19-17"><a href="lab-linear-regression.html#cb19-17" aria-hidden="true" tabindex="-1"></a><span class="do">## indus         0.020562   0.061433   0.335 0.737989    </span></span>
<span id="cb19-18"><a href="lab-linear-regression.html#cb19-18" aria-hidden="true" tabindex="-1"></a><span class="do">## chas          2.689026   0.859598   3.128 0.001863 ** </span></span>
<span id="cb19-19"><a href="lab-linear-regression.html#cb19-19" aria-hidden="true" tabindex="-1"></a><span class="do">## nox         -17.713540   3.679308  -4.814 1.97e-06 ***</span></span>
<span id="cb19-20"><a href="lab-linear-regression.html#cb19-20" aria-hidden="true" tabindex="-1"></a><span class="do">## rm            3.814394   0.408480   9.338  &lt; 2e-16 ***</span></span>
<span id="cb19-21"><a href="lab-linear-regression.html#cb19-21" aria-hidden="true" tabindex="-1"></a><span class="do">## dis          -1.478612   0.190611  -7.757 5.03e-14 ***</span></span>
<span id="cb19-22"><a href="lab-linear-regression.html#cb19-22" aria-hidden="true" tabindex="-1"></a><span class="do">## rad           0.305786   0.066089   4.627 4.75e-06 ***</span></span>
<span id="cb19-23"><a href="lab-linear-regression.html#cb19-23" aria-hidden="true" tabindex="-1"></a><span class="do">## tax          -0.012329   0.003755  -3.283 0.001099 ** </span></span>
<span id="cb19-24"><a href="lab-linear-regression.html#cb19-24" aria-hidden="true" tabindex="-1"></a><span class="do">## ptratio      -0.952211   0.130294  -7.308 1.10e-12 ***</span></span>
<span id="cb19-25"><a href="lab-linear-regression.html#cb19-25" aria-hidden="true" tabindex="-1"></a><span class="do">## black         0.009321   0.002678   3.481 0.000544 ***</span></span>
<span id="cb19-26"><a href="lab-linear-regression.html#cb19-26" aria-hidden="true" tabindex="-1"></a><span class="do">## lstat        -0.523852   0.047625 -10.999  &lt; 2e-16 ***</span></span>
<span id="cb19-27"><a href="lab-linear-regression.html#cb19-27" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb19-28"><a href="lab-linear-regression.html#cb19-28" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb19-29"><a href="lab-linear-regression.html#cb19-29" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb19-30"><a href="lab-linear-regression.html#cb19-30" aria-hidden="true" tabindex="-1"></a><span class="do">## Residual standard error: 4.74 on 493 degrees of freedom</span></span>
<span id="cb19-31"><a href="lab-linear-regression.html#cb19-31" aria-hidden="true" tabindex="-1"></a><span class="do">## Multiple R-squared:  0.7406, Adjusted R-squared:  0.7343 </span></span>
<span id="cb19-32"><a href="lab-linear-regression.html#cb19-32" aria-hidden="true" tabindex="-1"></a><span class="do">## F-statistic: 117.3 on 12 and 493 DF,  p-value: &lt; 2.2e-16</span></span></code></pre></div>
</div>
<div id="interaction-terms" class="section level2" number="7.3">
<h2><span class="header-section-number">7.3</span> Interaction Terms</h2>
<div class="sourceCode" id="cb20"><pre class="sourceCode r Rchunk"><code class="sourceCode r"><span id="cb20-1"><a href="lab-linear-regression.html#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(medv <span class="sc">~</span> lstat <span class="sc">*</span> age, <span class="at">data =</span> Boston))</span>
<span id="cb20-2"><a href="lab-linear-regression.html#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb20-3"><a href="lab-linear-regression.html#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Call:</span></span>
<span id="cb20-4"><a href="lab-linear-regression.html#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="do">## lm(formula = medv ~ lstat * age, data = Boston)</span></span>
<span id="cb20-5"><a href="lab-linear-regression.html#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb20-6"><a href="lab-linear-regression.html#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Residuals:</span></span>
<span id="cb20-7"><a href="lab-linear-regression.html#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="do">##     Min      1Q  Median      3Q     Max </span></span>
<span id="cb20-8"><a href="lab-linear-regression.html#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="do">## -15.806  -4.045  -1.333   2.085  27.552 </span></span>
<span id="cb20-9"><a href="lab-linear-regression.html#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb20-10"><a href="lab-linear-regression.html#cb20-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Coefficients:</span></span>
<span id="cb20-11"><a href="lab-linear-regression.html#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="do">##               Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb20-12"><a href="lab-linear-regression.html#cb20-12" aria-hidden="true" tabindex="-1"></a><span class="do">## (Intercept) 36.0885359  1.4698355  24.553  &lt; 2e-16 ***</span></span>
<span id="cb20-13"><a href="lab-linear-regression.html#cb20-13" aria-hidden="true" tabindex="-1"></a><span class="do">## lstat       -1.3921168  0.1674555  -8.313 8.78e-16 ***</span></span>
<span id="cb20-14"><a href="lab-linear-regression.html#cb20-14" aria-hidden="true" tabindex="-1"></a><span class="do">## age         -0.0007209  0.0198792  -0.036   0.9711    </span></span>
<span id="cb20-15"><a href="lab-linear-regression.html#cb20-15" aria-hidden="true" tabindex="-1"></a><span class="do">## lstat:age    0.0041560  0.0018518   2.244   0.0252 *  </span></span>
<span id="cb20-16"><a href="lab-linear-regression.html#cb20-16" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb20-17"><a href="lab-linear-regression.html#cb20-17" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb20-18"><a href="lab-linear-regression.html#cb20-18" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb20-19"><a href="lab-linear-regression.html#cb20-19" aria-hidden="true" tabindex="-1"></a><span class="do">## Residual standard error: 6.149 on 502 degrees of freedom</span></span>
<span id="cb20-20"><a href="lab-linear-regression.html#cb20-20" aria-hidden="true" tabindex="-1"></a><span class="do">## Multiple R-squared:  0.5557, Adjusted R-squared:  0.5531 </span></span>
<span id="cb20-21"><a href="lab-linear-regression.html#cb20-21" aria-hidden="true" tabindex="-1"></a><span class="do">## F-statistic: 209.3 on 3 and 502 DF,  p-value: &lt; 2.2e-16</span></span></code></pre></div>
</div>
<div id="non-linear-transformations-of-the-predictors" class="section level2" number="7.4">
<h2><span class="header-section-number">7.4</span> Non-linear Transformations of the Predictors</h2>
<p>The <code>lm()</code> function can also accommodate non-linear transformations of the predictors. For instance, given a predictor <span class="math inline">\(X\)</span>, we can create a predictor <span class="math inline">\(X^2\)</span> using <code>I(X^2)</code>. We now perform a regression of <code>medv</code> onto <code>lstat</code> and <code>lstat2</code>.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r Rchunk"><code class="sourceCode r"><span id="cb21-1"><a href="lab-linear-regression.html#cb21-1" aria-hidden="true" tabindex="-1"></a>lm.fit2 <span class="ot">=</span> <span class="fu">lm</span>(medv <span class="sc">~</span> lstat <span class="sc">+</span> <span class="fu">I</span>(lstat<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb21-2"><a href="lab-linear-regression.html#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm.fit2)</span>
<span id="cb21-3"><a href="lab-linear-regression.html#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb21-4"><a href="lab-linear-regression.html#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Call:</span></span>
<span id="cb21-5"><a href="lab-linear-regression.html#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="do">## lm(formula = medv ~ lstat + I(lstat^2))</span></span>
<span id="cb21-6"><a href="lab-linear-regression.html#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb21-7"><a href="lab-linear-regression.html#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Residuals:</span></span>
<span id="cb21-8"><a href="lab-linear-regression.html#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="do">##      Min       1Q   Median       3Q      Max </span></span>
<span id="cb21-9"><a href="lab-linear-regression.html#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="do">## -15.2834  -3.8313  -0.5295   2.3095  25.4148 </span></span>
<span id="cb21-10"><a href="lab-linear-regression.html#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb21-11"><a href="lab-linear-regression.html#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Coefficients:</span></span>
<span id="cb21-12"><a href="lab-linear-regression.html#cb21-12" aria-hidden="true" tabindex="-1"></a><span class="do">##              Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb21-13"><a href="lab-linear-regression.html#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="do">## (Intercept) 42.862007   0.872084   49.15   &lt;2e-16 ***</span></span>
<span id="cb21-14"><a href="lab-linear-regression.html#cb21-14" aria-hidden="true" tabindex="-1"></a><span class="do">## lstat       -2.332821   0.123803  -18.84   &lt;2e-16 ***</span></span>
<span id="cb21-15"><a href="lab-linear-regression.html#cb21-15" aria-hidden="true" tabindex="-1"></a><span class="do">## I(lstat^2)   0.043547   0.003745   11.63   &lt;2e-16 ***</span></span>
<span id="cb21-16"><a href="lab-linear-regression.html#cb21-16" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb21-17"><a href="lab-linear-regression.html#cb21-17" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb21-18"><a href="lab-linear-regression.html#cb21-18" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb21-19"><a href="lab-linear-regression.html#cb21-19" aria-hidden="true" tabindex="-1"></a><span class="do">## Residual standard error: 5.524 on 503 degrees of freedom</span></span>
<span id="cb21-20"><a href="lab-linear-regression.html#cb21-20" aria-hidden="true" tabindex="-1"></a><span class="do">## Multiple R-squared:  0.6407, Adjusted R-squared:  0.6393 </span></span>
<span id="cb21-21"><a href="lab-linear-regression.html#cb21-21" aria-hidden="true" tabindex="-1"></a><span class="do">## F-statistic: 448.5 on 2 and 503 DF,  p-value: &lt; 2.2e-16</span></span></code></pre></div>
<p>We use the <code>anova()</code> function to further quantify the extent to which the quadratic fit is superior to the linear fit.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r Rchunk"><code class="sourceCode r"><span id="cb22-1"><a href="lab-linear-regression.html#cb22-1" aria-hidden="true" tabindex="-1"></a>lm.fit <span class="ot">=</span> <span class="fu">lm</span>(medv <span class="sc">~</span> lstat)</span>
<span id="cb22-2"><a href="lab-linear-regression.html#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(lm.fit, lm.fit2)</span>
<span id="cb22-3"><a href="lab-linear-regression.html#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Analysis of Variance Table</span></span>
<span id="cb22-4"><a href="lab-linear-regression.html#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb22-5"><a href="lab-linear-regression.html#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Model 1: medv ~ lstat</span></span>
<span id="cb22-6"><a href="lab-linear-regression.html#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Model 2: medv ~ lstat + I(lstat^2)</span></span>
<span id="cb22-7"><a href="lab-linear-regression.html#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="do">##   Res.Df   RSS Df Sum of Sq     F    Pr(&gt;F)    </span></span>
<span id="cb22-8"><a href="lab-linear-regression.html#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="do">## 1    504 19472                                 </span></span>
<span id="cb22-9"><a href="lab-linear-regression.html#cb22-9" aria-hidden="true" tabindex="-1"></a><span class="do">## 2    503 15347  1    4125.1 135.2 &lt; 2.2e-16 ***</span></span>
<span id="cb22-10"><a href="lab-linear-regression.html#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb22-11"><a href="lab-linear-regression.html#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>Here <strong>Model 1</strong> represents the linear submodel containing only one predictor, <code>lstat</code>, while <strong>Model 2</strong> corresponds to the larger quadratic model that has two predictors, <code>lstat</code> and <code>lstat2</code>.</p>
<p>The <code>anova()</code> function performs a hypothesis test comparing the two models. The null hypothesis is that the two models fit the data equally well, and the alternative hypothesis is that the full model is superior. Here the F-statistic is 135 and the associated p-value is virtually zero. This provides very clear evidence that the model containing the predictors <code>lstat</code> and <code>lstat2</code> is far superior to the model that only contains the predictor <code>lstat</code>. This is not surprising, since earlier we saw evidence for non-linearity in the relationship between <code>medv</code> and <code>lstat</code>. If we type</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r Rchunk"><code class="sourceCode r"><span id="cb23-1"><a href="lab-linear-regression.html#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb23-2"><a href="lab-linear-regression.html#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lm.fit2)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-32-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>then we see that when the <code>lstat2</code> term is included in the model, there is little discernible pattern in the residuals.</p>
<p>A better approach involves using the <code>poly()</code> function to create the polynomial within <code>lm()</code>. For example, the following command produces a fifth-order polynomial fit:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r Rchunk"><code class="sourceCode r"><span id="cb24-1"><a href="lab-linear-regression.html#cb24-1" aria-hidden="true" tabindex="-1"></a>lm.fit5 <span class="ot">=</span> <span class="fu">lm</span>(medv <span class="sc">~</span> <span class="fu">poly</span>(lstat, <span class="dv">5</span>))</span>
<span id="cb24-2"><a href="lab-linear-regression.html#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm.fit5)</span>
<span id="cb24-3"><a href="lab-linear-regression.html#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb24-4"><a href="lab-linear-regression.html#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Call:</span></span>
<span id="cb24-5"><a href="lab-linear-regression.html#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="do">## lm(formula = medv ~ poly(lstat, 5))</span></span>
<span id="cb24-6"><a href="lab-linear-regression.html#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb24-7"><a href="lab-linear-regression.html#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Residuals:</span></span>
<span id="cb24-8"><a href="lab-linear-regression.html#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="do">##      Min       1Q   Median       3Q      Max </span></span>
<span id="cb24-9"><a href="lab-linear-regression.html#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="do">## -13.5433  -3.1039  -0.7052   2.0844  27.1153 </span></span>
<span id="cb24-10"><a href="lab-linear-regression.html#cb24-10" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb24-11"><a href="lab-linear-regression.html#cb24-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Coefficients:</span></span>
<span id="cb24-12"><a href="lab-linear-regression.html#cb24-12" aria-hidden="true" tabindex="-1"></a><span class="do">##                  Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb24-13"><a href="lab-linear-regression.html#cb24-13" aria-hidden="true" tabindex="-1"></a><span class="do">## (Intercept)       22.5328     0.2318  97.197  &lt; 2e-16 ***</span></span>
<span id="cb24-14"><a href="lab-linear-regression.html#cb24-14" aria-hidden="true" tabindex="-1"></a><span class="do">## poly(lstat, 5)1 -152.4595     5.2148 -29.236  &lt; 2e-16 ***</span></span>
<span id="cb24-15"><a href="lab-linear-regression.html#cb24-15" aria-hidden="true" tabindex="-1"></a><span class="do">## poly(lstat, 5)2   64.2272     5.2148  12.316  &lt; 2e-16 ***</span></span>
<span id="cb24-16"><a href="lab-linear-regression.html#cb24-16" aria-hidden="true" tabindex="-1"></a><span class="do">## poly(lstat, 5)3  -27.0511     5.2148  -5.187 3.10e-07 ***</span></span>
<span id="cb24-17"><a href="lab-linear-regression.html#cb24-17" aria-hidden="true" tabindex="-1"></a><span class="do">## poly(lstat, 5)4   25.4517     5.2148   4.881 1.42e-06 ***</span></span>
<span id="cb24-18"><a href="lab-linear-regression.html#cb24-18" aria-hidden="true" tabindex="-1"></a><span class="do">## poly(lstat, 5)5  -19.2524     5.2148  -3.692 0.000247 ***</span></span>
<span id="cb24-19"><a href="lab-linear-regression.html#cb24-19" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb24-20"><a href="lab-linear-regression.html#cb24-20" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb24-21"><a href="lab-linear-regression.html#cb24-21" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb24-22"><a href="lab-linear-regression.html#cb24-22" aria-hidden="true" tabindex="-1"></a><span class="do">## Residual standard error: 5.215 on 500 degrees of freedom</span></span>
<span id="cb24-23"><a href="lab-linear-regression.html#cb24-23" aria-hidden="true" tabindex="-1"></a><span class="do">## Multiple R-squared:  0.6817, Adjusted R-squared:  0.6785 </span></span>
<span id="cb24-24"><a href="lab-linear-regression.html#cb24-24" aria-hidden="true" tabindex="-1"></a><span class="do">## F-statistic: 214.2 on 5 and 500 DF,  p-value: &lt; 2.2e-16</span></span></code></pre></div>
<p>This suggests that including additional polynomial terms, up to fifth order, leads to an improvement in the model fit! However, further investigation of the data reveals that no polynomial terms beyond fifth order have significant p-values in a regression fit.</p>
<p>Of course, we are in no way restricted to using polynomial transformations of the predictors. Here we try a log transformation.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r Rchunk"><code class="sourceCode r"><span id="cb25-1"><a href="lab-linear-regression.html#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(medv <span class="sc">~</span> <span class="fu">log</span>(rm), <span class="at">data =</span> Boston))</span>
<span id="cb25-2"><a href="lab-linear-regression.html#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb25-3"><a href="lab-linear-regression.html#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Call:</span></span>
<span id="cb25-4"><a href="lab-linear-regression.html#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="do">## lm(formula = medv ~ log(rm), data = Boston)</span></span>
<span id="cb25-5"><a href="lab-linear-regression.html#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb25-6"><a href="lab-linear-regression.html#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Residuals:</span></span>
<span id="cb25-7"><a href="lab-linear-regression.html#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="do">##     Min      1Q  Median      3Q     Max </span></span>
<span id="cb25-8"><a href="lab-linear-regression.html#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="do">## -19.487  -2.875  -0.104   2.837  39.816 </span></span>
<span id="cb25-9"><a href="lab-linear-regression.html#cb25-9" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb25-10"><a href="lab-linear-regression.html#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Coefficients:</span></span>
<span id="cb25-11"><a href="lab-linear-regression.html#cb25-11" aria-hidden="true" tabindex="-1"></a><span class="do">##             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb25-12"><a href="lab-linear-regression.html#cb25-12" aria-hidden="true" tabindex="-1"></a><span class="do">## (Intercept)  -76.488      5.028  -15.21   &lt;2e-16 ***</span></span>
<span id="cb25-13"><a href="lab-linear-regression.html#cb25-13" aria-hidden="true" tabindex="-1"></a><span class="do">## log(rm)       54.055      2.739   19.73   &lt;2e-16 ***</span></span>
<span id="cb25-14"><a href="lab-linear-regression.html#cb25-14" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb25-15"><a href="lab-linear-regression.html#cb25-15" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb25-16"><a href="lab-linear-regression.html#cb25-16" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb25-17"><a href="lab-linear-regression.html#cb25-17" aria-hidden="true" tabindex="-1"></a><span class="do">## Residual standard error: 6.915 on 504 degrees of freedom</span></span>
<span id="cb25-18"><a href="lab-linear-regression.html#cb25-18" aria-hidden="true" tabindex="-1"></a><span class="do">## Multiple R-squared:  0.4358, Adjusted R-squared:  0.4347 </span></span>
<span id="cb25-19"><a href="lab-linear-regression.html#cb25-19" aria-hidden="true" tabindex="-1"></a><span class="do">## F-statistic: 389.3 on 1 and 504 DF,  p-value: &lt; 2.2e-16</span></span></code></pre></div>
</div>
<div id="qualitative-predictors" class="section level2" number="7.5">
<h2><span class="header-section-number">7.5</span> Qualitative Predictors</h2>
<p>We will now examine the <code>Carseats</code> data, which is part of the <code>ISLR2</code> library. We will attempt to predict Sales (child car seat sales) in 400 locations based on a number of predictors.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r Rchunk"><code class="sourceCode r"><span id="cb26-1"><a href="lab-linear-regression.html#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Carseats)</span>
<span id="cb26-2"><a href="lab-linear-regression.html#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="do">##   Sales CompPrice Income Advertising Population Price ShelveLoc Age Education</span></span>
<span id="cb26-3"><a href="lab-linear-regression.html#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="do">## 1  9.50       138     73          11        276   120       Bad  42        17</span></span>
<span id="cb26-4"><a href="lab-linear-regression.html#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="do">## 2 11.22       111     48          16        260    83      Good  65        10</span></span>
<span id="cb26-5"><a href="lab-linear-regression.html#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="do">## 3 10.06       113     35          10        269    80    Medium  59        12</span></span>
<span id="cb26-6"><a href="lab-linear-regression.html#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="do">## 4  7.40       117    100           4        466    97    Medium  55        14</span></span>
<span id="cb26-7"><a href="lab-linear-regression.html#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="do">## 5  4.15       141     64           3        340   128       Bad  38        13</span></span>
<span id="cb26-8"><a href="lab-linear-regression.html#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="do">## 6 10.81       124    113          13        501    72       Bad  78        16</span></span>
<span id="cb26-9"><a href="lab-linear-regression.html#cb26-9" aria-hidden="true" tabindex="-1"></a><span class="do">##   Urban  US</span></span>
<span id="cb26-10"><a href="lab-linear-regression.html#cb26-10" aria-hidden="true" tabindex="-1"></a><span class="do">## 1   Yes Yes</span></span>
<span id="cb26-11"><a href="lab-linear-regression.html#cb26-11" aria-hidden="true" tabindex="-1"></a><span class="do">## 2   Yes Yes</span></span>
<span id="cb26-12"><a href="lab-linear-regression.html#cb26-12" aria-hidden="true" tabindex="-1"></a><span class="do">## 3   Yes Yes</span></span>
<span id="cb26-13"><a href="lab-linear-regression.html#cb26-13" aria-hidden="true" tabindex="-1"></a><span class="do">## 4   Yes Yes</span></span>
<span id="cb26-14"><a href="lab-linear-regression.html#cb26-14" aria-hidden="true" tabindex="-1"></a><span class="do">## 5   Yes  No</span></span>
<span id="cb26-15"><a href="lab-linear-regression.html#cb26-15" aria-hidden="true" tabindex="-1"></a><span class="do">## 6    No Yes</span></span></code></pre></div>
<p>The <code>Carseats</code> data includes qualitative predictors such as <code>Shelveloc</code>, an indicator
of the quality of the shelving location—that is, the space within a store in which the car seat is displayed—at each location.</p>
<p>The predictor Shelveloc takes on three possible values: <em>Bad</em>, <em>Medium</em>, and <em>Good</em>. Given a qualitative variable such as <code>Shelveloc</code>, R generates dummy variables automatically. Below we fit a multiple regression model that includes some interaction terms.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r Rchunk"><code class="sourceCode r"><span id="cb27-1"><a href="lab-linear-regression.html#cb27-1" aria-hidden="true" tabindex="-1"></a>lm.fit <span class="ot">=</span> <span class="fu">lm</span>(Sales <span class="sc">~</span> . <span class="sc">+</span> Income<span class="sc">:</span>Advertising <span class="sc">+</span> Price<span class="sc">:</span>Age, <span class="at">data =</span> Carseats)</span>
<span id="cb27-2"><a href="lab-linear-regression.html#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm.fit)</span>
<span id="cb27-3"><a href="lab-linear-regression.html#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb27-4"><a href="lab-linear-regression.html#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Call:</span></span>
<span id="cb27-5"><a href="lab-linear-regression.html#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="do">## lm(formula = Sales ~ . + Income:Advertising + Price:Age, data = Carseats)</span></span>
<span id="cb27-6"><a href="lab-linear-regression.html#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb27-7"><a href="lab-linear-regression.html#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Residuals:</span></span>
<span id="cb27-8"><a href="lab-linear-regression.html#cb27-8" aria-hidden="true" tabindex="-1"></a><span class="do">##     Min      1Q  Median      3Q     Max </span></span>
<span id="cb27-9"><a href="lab-linear-regression.html#cb27-9" aria-hidden="true" tabindex="-1"></a><span class="do">## -2.9208 -0.7503  0.0177  0.6754  3.3413 </span></span>
<span id="cb27-10"><a href="lab-linear-regression.html#cb27-10" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb27-11"><a href="lab-linear-regression.html#cb27-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Coefficients:</span></span>
<span id="cb27-12"><a href="lab-linear-regression.html#cb27-12" aria-hidden="true" tabindex="-1"></a><span class="do">##                      Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb27-13"><a href="lab-linear-regression.html#cb27-13" aria-hidden="true" tabindex="-1"></a><span class="do">## (Intercept)         6.5755654  1.0087470   6.519 2.22e-10 ***</span></span>
<span id="cb27-14"><a href="lab-linear-regression.html#cb27-14" aria-hidden="true" tabindex="-1"></a><span class="do">## CompPrice           0.0929371  0.0041183  22.567  &lt; 2e-16 ***</span></span>
<span id="cb27-15"><a href="lab-linear-regression.html#cb27-15" aria-hidden="true" tabindex="-1"></a><span class="do">## Income              0.0108940  0.0026044   4.183 3.57e-05 ***</span></span>
<span id="cb27-16"><a href="lab-linear-regression.html#cb27-16" aria-hidden="true" tabindex="-1"></a><span class="do">## Advertising         0.0702462  0.0226091   3.107 0.002030 ** </span></span>
<span id="cb27-17"><a href="lab-linear-regression.html#cb27-17" aria-hidden="true" tabindex="-1"></a><span class="do">## Population          0.0001592  0.0003679   0.433 0.665330    </span></span>
<span id="cb27-18"><a href="lab-linear-regression.html#cb27-18" aria-hidden="true" tabindex="-1"></a><span class="do">## Price              -0.1008064  0.0074399 -13.549  &lt; 2e-16 ***</span></span>
<span id="cb27-19"><a href="lab-linear-regression.html#cb27-19" aria-hidden="true" tabindex="-1"></a><span class="do">## ShelveLocGood       4.8486762  0.1528378  31.724  &lt; 2e-16 ***</span></span>
<span id="cb27-20"><a href="lab-linear-regression.html#cb27-20" aria-hidden="true" tabindex="-1"></a><span class="do">## ShelveLocMedium     1.9532620  0.1257682  15.531  &lt; 2e-16 ***</span></span>
<span id="cb27-21"><a href="lab-linear-regression.html#cb27-21" aria-hidden="true" tabindex="-1"></a><span class="do">## Age                -0.0579466  0.0159506  -3.633 0.000318 ***</span></span>
<span id="cb27-22"><a href="lab-linear-regression.html#cb27-22" aria-hidden="true" tabindex="-1"></a><span class="do">## Education          -0.0208525  0.0196131  -1.063 0.288361    </span></span>
<span id="cb27-23"><a href="lab-linear-regression.html#cb27-23" aria-hidden="true" tabindex="-1"></a><span class="do">## UrbanYes            0.1401597  0.1124019   1.247 0.213171    </span></span>
<span id="cb27-24"><a href="lab-linear-regression.html#cb27-24" aria-hidden="true" tabindex="-1"></a><span class="do">## USYes              -0.1575571  0.1489234  -1.058 0.290729    </span></span>
<span id="cb27-25"><a href="lab-linear-regression.html#cb27-25" aria-hidden="true" tabindex="-1"></a><span class="do">## Income:Advertising  0.0007510  0.0002784   2.698 0.007290 ** </span></span>
<span id="cb27-26"><a href="lab-linear-regression.html#cb27-26" aria-hidden="true" tabindex="-1"></a><span class="do">## Price:Age           0.0001068  0.0001333   0.801 0.423812    </span></span>
<span id="cb27-27"><a href="lab-linear-regression.html#cb27-27" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb27-28"><a href="lab-linear-regression.html#cb27-28" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb27-29"><a href="lab-linear-regression.html#cb27-29" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb27-30"><a href="lab-linear-regression.html#cb27-30" aria-hidden="true" tabindex="-1"></a><span class="do">## Residual standard error: 1.011 on 386 degrees of freedom</span></span>
<span id="cb27-31"><a href="lab-linear-regression.html#cb27-31" aria-hidden="true" tabindex="-1"></a><span class="do">## Multiple R-squared:  0.8761, Adjusted R-squared:  0.8719 </span></span>
<span id="cb27-32"><a href="lab-linear-regression.html#cb27-32" aria-hidden="true" tabindex="-1"></a><span class="do">## F-statistic:   210 on 13 and 386 DF,  p-value: &lt; 2.2e-16</span></span></code></pre></div>
<p>The contrasts() function returns the coding that R uses for the dummy <code>contrasts()</code> variables.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r Rchunk"><code class="sourceCode r"><span id="cb28-1"><a href="lab-linear-regression.html#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(Carseats)</span>
<span id="cb28-2"><a href="lab-linear-regression.html#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(ShelveLoc)</span>
<span id="cb28-3"><a href="lab-linear-regression.html#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="do">##        Good Medium</span></span>
<span id="cb28-4"><a href="lab-linear-regression.html#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Bad       0      0</span></span>
<span id="cb28-5"><a href="lab-linear-regression.html#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Good      1      0</span></span>
<span id="cb28-6"><a href="lab-linear-regression.html#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Medium    0      1</span></span></code></pre></div>
<p>R has created a <code>ShelveLocGood</code> dummy variable that takes on a value of 1 if the shelving location is good, and 0 otherwise. It has also created a <code>ShelveLocMedium</code> dummy variable that equals 1 if the shelving location is medium, and 0 otherwise. A bad shelving location corresponds to a zero for each of the two dummy variables.</p>
<p>The fact that the coefficient for <code>ShelveLocGood</code> in the regression output is positive indicates that a good shelving location is associated with high sales (relative to a bad location). And <code>ShelveLocMedium</code> has a smaller positive coefficient, indicating that a
medium shelving location is associated with higher sales than a bad shelving
location but lower sales than a good shelving location.</p>
</div>
<div id="writing-functions" class="section level2" number="7.6">
<h2><span class="header-section-number">7.6</span> Writing Functions</h2>
<p>In order to write our own function, for instance, below we provide a simple function that reads in the <code>ISLR2</code> and <code>MASS</code> libraries, called
<code>LoadLibraries()</code>.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r Rchunk"><code class="sourceCode r"><span id="cb29-1"><a href="lab-linear-regression.html#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create the function</span></span>
<span id="cb29-2"><a href="lab-linear-regression.html#cb29-2" aria-hidden="true" tabindex="-1"></a>LoadLibraries <span class="ot">=</span> <span class="cf">function</span>() {</span>
<span id="cb29-3"><a href="lab-linear-regression.html#cb29-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">library</span>(ISLR)</span>
<span id="cb29-4"><a href="lab-linear-regression.html#cb29-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">library</span>(MASS)</span>
<span id="cb29-5"><a href="lab-linear-regression.html#cb29-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="st">&quot;The libraries have been loaded.&quot;</span>)</span>
<span id="cb29-6"><a href="lab-linear-regression.html#cb29-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-7"><a href="lab-linear-regression.html#cb29-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-8"><a href="lab-linear-regression.html#cb29-8" aria-hidden="true" tabindex="-1"></a><span class="co"># execute the function</span></span>
<span id="cb29-9"><a href="lab-linear-regression.html#cb29-9" aria-hidden="true" tabindex="-1"></a><span class="fu">LoadLibraries</span>()</span>
<span id="cb29-10"><a href="lab-linear-regression.html#cb29-10" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] &quot;The libraries have been loaded.&quot;</span></span></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="case-study---marketing-plan.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="exercises.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
