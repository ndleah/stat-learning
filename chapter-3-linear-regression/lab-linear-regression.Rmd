---
output:
  md_document:
    variant: markdown_github
---

```{r include=FALSE}
gitbook(fig_caption = TRUE, number_sections = TRUE,
  self_contained = FALSE, anchor_sections = TRUE,
  lib_dir = "libs", global_numbering = !number_sections,
  pandoc_args = NULL, ..., template = "default",
  split_by = c("chapter", "chapter+number", "section",
    "section+number", "rmd", "none"), split_bib = TRUE,
  config = list(), table_css = TRUE)
```

# Chapter 3 Lab: Linear Regression

```{r}
library(MASS)
library(ISLR)
```

# Simple Linear Regression

The Boston data set records `medv` (median house value) for 506 neighborhoods around Boston. We will seek to predict `medv` using 13 predictors such as `rm` (average number of rooms per house), `age` (average age of houses), and `lstat` (percent of households with low socioeconomic status).

```{r}
fix(Boston)
names(Boston)
```

We will start by using the `lm()` function to fit a simple linear regression `lm()` model, with `medv` as the response and `lstat` as the predictor.


```{r}
lm.fit=lm(medv~lstat,Boston)
lm.fit
```

For more detailed information, we use `summary(lm.fit)`. This gives us p-values and standard errors for the coefficients, as well as the $$R^2$$ statistic and F-statistic for the model.

```{r}
summary(lm.fit)
```

We can use `names()` function in oeder to find out what other pieces of information are store in `lm.fit`.

```{r}
names(lm.fit)
```

Assessing the coefficient of the model:

```{r}
coef(lm.fit)
```

Assessing the confidence interval for the coefficient estimates:

```{r}
confint(lm.fit)
```

To produce confidence interval an prediction intervals for the prediction of `medv` for a given value of `lstat`.

```{r}
predict(lm.fit,data.frame(lstat=(c(5,10,15))), interval="confidence")
```

```{r}
predict(lm.fit,data.frame(lstat=(c(5,10,15))), interval="prediction")
```


We will now plot `medv` and `lstat` along with the least squares regression line using the `plot()` and `abline()` functions.

```{r}
attach(Boston)
plot(lstat,medv)
abline(lm.fit)
```
Next we examine some diagnostic plots, several of which were discussed. Four diagnostic plots are automatically produced by applying the `plot()` function directly to the output from `lm()`.

```{r}
par(mfrow=c(2,2))
plot(lm.fit)
```


```{r}
plot(predict(lm.fit), residuals(lm.fit))
```
Alternatively, we can compute the residuals from a linear regression fit using the `residuals()` function. The function `rstudent()` will return the studentized residuals, and we can use this function to plot the residuals against the fitted values.

```{r}
plot(predict(lm.fit), rstudent(lm.fit))
```

On the basis of the residual plots, there is some evidence of non-linearity. Leverage statistics can be computed for any number of predictors using the `hatvalues()` function.


```{r}
plot(hatvalues(lm.fit))
```


The `which.max()` function identifies the index of the largest element of a `which.max()` vector. In this case, it tells us which observation has the largest leverage statistic.

```{r}
which.max(hatvalues(lm.fit))
```

## Multiple Linear Regression


```{r}
```


```{r}
```


```{r}
```


```{r}
```







```{r}

```

# Multiple Linear Regression

lm.fit=lm(medv~lstat+age,data=Boston)
summary(lm.fit)
lm.fit=lm(medv~.,data=Boston)
summary(lm.fit)
library(car)
vif(lm.fit)
lm.fit1=lm(medv~.-age,data=Boston)
summary(lm.fit1)
lm.fit1=update(lm.fit, ~.-age)

# Interaction Terms

summary(lm(medv~lstat*age,data=Boston))

# Non-linear Transformations of the Predictors

lm.fit2=lm(medv~lstat+I(lstat^2))
summary(lm.fit2)
lm.fit=lm(medv~lstat)
anova(lm.fit,lm.fit2)
par(mfrow=c(2,2))
plot(lm.fit2)
lm.fit5=lm(medv~poly(lstat,5))
summary(lm.fit5)
summary(lm(medv~log(rm),data=Boston))

# Qualitative Predictors

fix(Carseats)
names(Carseats)
lm.fit=lm(Sales~.+Income:Advertising+Price:Age,data=Carseats)
summary(lm.fit)
attach(Carseats)
contrasts(ShelveLoc)

# Writing Functions

LoadLibraries
LoadLibraries()
LoadLibraries=function(){
 library(ISLR)
 library(MASS)
 print("The libraries have been loaded.")
 }
LoadLibraries
LoadLibraries()
